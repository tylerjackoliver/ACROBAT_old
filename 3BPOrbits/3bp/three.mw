<?xml version="1.0" encoding="UTF-8"?>
<Worksheet><Version major="6" minor="0"/><View-Properties><Zoom percentage="100"/></View-Properties><Styles><Layout alignment="left" firstindent="0.0" leftmargin="0.0" linebreak="space" linespacing="0.0" name="Normal" rightmargin="0.0" spaceabove="0.0" spacebelow="0.0"/><Font background="[0,0,0]" bold="true" name="_cstyle256"/><Font background="[0,0,0]" bold="false" executable="false" family="Lucida Bright" foreground="[0,0,0]" italic="false" name="Normal" readonly="false" size="12" underline="false"/><Font background="[0,0,0]" bold="true" executable="true" family="Monospaced" foreground="[255,0,0]" name="Maple Input"/><Font background="[0,0,0]" family="Lucida Bright" name="Page Number" underline="false"/></Styles><Page-Numbers enabled="false" first-number="1" first-numbered-page="1" horizontal-location="right" style="Page Number" vertical-location="bottom"/><Group><Input><Text-field layout="Normal" style="Normal">Chapter 4</Text-field><Text-field layout="Normal" style="_cstyle256"><Font executable="false" family="Lucida Bright" foreground="[0,0,0]" italic="false" size="12" underline="false">Orbits in the Planar Three-Body Problem</Font></Text-field><Text-field layout="Normal" style="Normal">D. Gruntz, gruntz@fh-aargau.ch,  and</Text-field><Text-field layout="Normal" style="Normal">J. Waldvogel, waldvogel@sam.math.ethz.ch</Text-field><Text-field layout="Normal" style="Normal"/></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input"><Font italic="false" size="12" underline="false">restart;
x := x1 + I*x2: 
y := y1 + I*y2:
X := ((x^2-y^2)/2)^2:
Y := ((x^2+y^2)/2)^2:
r0 := factor(evalc(abs(Y-X))):
r0 := simplify(r0, power, symbolic);</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input"><Font italic="false" size="12" underline="false">r1 := factor(evalc(abs(Y)));</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input"><Font italic="false" size="12" underline="false">r2 := factor(evalc(abs(X)));</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input"><Font italic="false" size="12" underline="false">read `reduce`;
r1 := reduce(r1);</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input"><Font italic="false" size="12" underline="false">r2 := reduce(r2);</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" style="Normal"/><Text-field layout="Normal" style="Normal">Derivation of the gradient of the regularized Hamiltonian K</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input"><Font italic="false" size="12" underline="false">restart;
read `K`;
eval(K);</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input"><Font italic="false" size="12" underline="false">SK := codegen[split](K);</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input"><Font italic="false" size="12" underline="false">GRADK := codegen[GRADIENT](SK);</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input"><Font italic="false" size="12" underline="false">codegen[cost](GRADK);</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input"><Font italic="false" size="12" underline="false">GRADKopt := codegen[optimize](GRADK);</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input"><Font italic="false" size="12" underline="false">codegen[cost](GRADKopt);</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input"><Font italic="false" size="12" underline="false">G1 := linalg[grad](K(x1,x2,y1,y2,p1,p2,q1,q2),
                        [x1,x2,y1,y2,p1,p2,q1,q2]):
G2 := [GRADKopt(x1,x2,y1,y2,p1,p2,q1,q2)]:
zip((g1,g2)-&gt;expand(g1-g2), convert(G1, list), G2);</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" style="Normal"/><Text-field layout="Normal" style="Normal">The Pythagorean Three-Body Problem</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input"><Font italic="false" size="12" underline="false">Digits := 20:
X := 4*I:
Y := -3:
x := sqrt(sqrt(Y)+sqrt(X));</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input"><Font italic="false" size="12" underline="false">x := map(t-&gt;map(radnormal,t),evalc(x));</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input"><Font italic="false" size="12" underline="false">evalf(%);</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input"><Font italic="false" size="12" underline="false">y := sqrt(sqrt(Y)-sqrt(X));</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input"><Font italic="false" size="12" underline="false">y := map(t-&gt;map(radnormal,t),evalc(y));</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input"><Font italic="false" size="12" underline="false">evalf(%);</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input"><Font italic="false" size="12" underline="false">m0 := 5: m1 := 3: m2 := 4: 
radnormal(K(Re(x), Im(x), Re(y), Im(y), 0, 0, 0, 0));</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input"><Font italic="false" size="12" underline="false">solve(%, EE);</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" style="Normal"/><Text-field layout="Normal" style="Normal">Derivation of symbolic expressions for P and Q</Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input"><Font italic="false" size="12" underline="false">x := 'x': y := 'y':
B := linalg[matrix](2,2,[[x*(x^2-y^2), -y*(x^2-y^2)],
                         [x*(x^2+y^2), y*(x^2+y^2)]]);</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input"><Font italic="false" size="12" underline="false">invB := linalg[inverse](transpose(B)):
pq := linalg[vector]([p,q]):
PQ := map(normal,linalg[multiply](invB,pq));</Font></Text-field></Input></Group><Group><Input><Text-field layout="Normal" prompt="&gt; " style="Maple Input"/></Input></Group><Text-field/><Text-field/></Worksheet>